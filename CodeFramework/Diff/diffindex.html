<!DOCTYPE html>
<html lang="en">
<head>
    <link href="diffview.css" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="jquery.min.js"></script>
    <script type="text/javascript" src="difflib.js"></script>
    <script type="text/javascript" src="diffview.js"></script>
    <script>
    function diffUsingJS() {
        var base = difflib.stringAsLines("{BASE_TEXT}");
        var newtxt = difflib.stringAsLines("{NEW_TEXT}");
        var sm = new difflib.SequenceMatcher(base, newtxt);
        var opcodes = sm.get_opcodes();
        var diffoutputdiv = document.body;
        while (diffoutputdiv.firstChild) diffoutputdiv.removeChild(diffoutputdiv.firstChild);
        diffoutputdiv.appendChild(diffview.buildView({
            baseTextLines: base,
            newTextLines: newtxt,
            opcodes: opcodes,
            baseTextName: "Base Text",
            newTextName: "New Text",
            contextSize: 3,
            viewType: 1
        }));
    }
    
    function addComments(comments) {
        for (var i = 0; i < comments.length; i++) {
            var comment = comments[i];
            var $comment = $("<tr data-id='" + comment.Id + "' class='comment'><td colspan='3'><div class='inner'><header><img src='" + comment.Avatar + "' />" + comment.User + "</header><div class='content'>" + comment.Content + "</div></div></td></tr>");
            
            if (comment['LineTo'] != null) {
                $("tr[data-to='" + comment.LineTo + "']").after($comment);
            }
            else if (comment['LineFrom'] != null) {
                $("tr[data-from='" + comment.LineFrom + "']").after($comment);
            }
            else if (comment['Parent'] != null) {
                $("tr[data-id='" + comment.Parent + "']").after($comment);
            }
        }
    }
    </script>
</head>
<body onload="diffUsingJS();">
</body>
</html>